qubes-utils (4.0.34) unstable; urgency=medium

  * makefile: specify PYTHON at build stage too

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Wed, 16 Jun 2021 17:24:35 +0200

qubes-utils (4.0.33) wheezy; urgency=medium

  [ Shawn Anastasio ]
  * Makefile: remove broken 32-bit host check

  [ Frédéric Pierret (fepitre) ]
  * kernel-vm-support: add make as BR

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Thu, 13 May 2021 06:27:53 +0200

qubes-utils (4.0.32) unstable; urgency=medium

  [ Frédéric Pierret (fepitre) ]
  * Add .gitlab-ci.yml

  [ Marek Marczykowski-Górecki ]
  * gitlab-ci: add custom jobs
  * ci: add coverage

  [ Frédéric Pierret (fepitre) ]
  * debian: update control
  * debian: update compat

  [ Demi Marie Obenour ]
  * Fix some links to more modern versions
  * Meminfo writer comes before user logins
  * Modernize systemd unit files
  * Validate remote filename before displaying it

  [ Marek Marczykowski-Górecki ]
  * Revert "debian: drop python2 on bullseye"

  [ Paweł Marczewski ]
  * Drop Python 2 support

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Wed, 17 Mar 2021 03:16:24 +0100

qubes-utils (4.0.31) unstable; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * dracut: remove useless use of basename

  [ Rusty Bird ]
  * imgconverter: make output reproducible by omitting timestamps

  [ Marek Marczykowski-Górecki ]
  * debian: don't fail package install on missing /var/lib/qubes
  * makefile: use 'python2' explicitly when needed, instead of just
    'python'

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sun, 25 Oct 2020 03:40:39 +0100

qubes-utils (4.0.30) unstable; urgency=medium

  * debian: drop python2 on bullseye
  * travis: update config

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sun, 05 Jul 2020 03:49:44 +0200

qubes-utils (4.0.29) unstable; urgency=medium

  * debian: add Provides: python3-qubesimgconverter

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Thu, 02 Jul 2020 04:28:57 +0200

qubes-utils (4.0.28) unstable; urgency=medium

  [ Ilpo Järvinen ]
  * Use proc_ops instead of file_operations on 5.6 kernels
  * Get virt_to_phys from header

  [ Paweł Marczewski ]
  * Image.get_through_dvm: support Python 3
  * qubesimgconverter: include Python 3 version in Debian package

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 17 Mar 2020 02:08:38 +0100

qubes-utils (4.0.27) unstable; urgency=medium

  [ Frédéric Pierret (fepitre) ]
  * travis: switch to bionic

  [ Marek Marczykowski-Górecki ]
  * travis: update python versions

  [ Patrick Schleizer ]
  * qubes-kernel-vm-support.preinst create folder /boot/grub
  * qubes-kernel-vm-support.postinst run update-grub

  [ Marek Marczykowski-Górecki ]
  * debian: fix dependencies of qubes-kernel-vm-support pkg

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Fri, 31 Jan 2020 03:54:15 +0100

qubes-utils (4.0.26) unstable; urgency=medium

  [ M. Vefa Bicakci ]
  * u2mfn: Make compatible with kernel versions >= 5.3.y

  [ Marek Marczykowski-Górecki ]
  * rpm: update python2 deps

  [ xaki23 ]
  * align volatile swap partition to 1Mb instead of 512b

  [ Marek Marczykowski-Górecki ]
  * Disable BLS config style in grub

  [ xaki23 ]
  * partition full volatile for non-COW setups too

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sat, 28 Sep 2019 12:11:44 +0200

qubes-utils (4.0.25) unstable; urgency=medium

  * initrd: mount / rw for the overlayfs setup time

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Mon, 10 Jun 2019 00:42:47 +0200

qubes-utils (4.0.24) unstable; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * Declare u2mfn module version, skip build for qubes kernels

  [ Frédéric Pierret (fepitre) ]
  * python3: use macro pkgversion
  * travis: switch to xenial
  * travis: remove older Fedora releases and add Fedora 30

  [ Marek Marczykowski-Górecki ]
  * initramfs: use overlayfs for /lib/modules, if available

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Thu, 06 Jun 2019 21:30:30 +0200

qubes-utils (4.0.23) unstable; urgency=medium

  * Disable scrubbing memory pages during initial balloon down
  * dracut: fix checking for "Root filesystem" label, improve udev sync
  * dracut: add a flag file indicating scrub-pages option support
  * Adjust permissions of /dev/xen/hypercall
  * Do not use /proc/xen for detecting dom0 anymore
  * Really install xen-scrub-pages dracut module
  * Add xen_scrub_pages=0 kernel option only if initramfs was rebuilt

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Mon, 25 Feb 2019 21:46:52 +0100

qubes-utils (4.0.22) unstable; urgency=medium

  * tests: skip img converter test if qubes-img-converter is not
    installed
  * imgconverter: allow icons up to 2048x2048
  * tests: skip the other img converter test too

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Mon, 29 Oct 2018 01:03:59 +0100

qubes-utils (4.0.21) unstable; urgency=medium

  [ Rusty Bird ]
  * Order qubes-meminfo-writer-dom0 before systemd-user-sessions

  [ Marek Marczykowski-Górecki ]
  * rpm: adjust for fc29
  * travis: update Fedora and Debian versions

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 09 Oct 2018 00:25:11 +0200

qubes-utils (4.0.20) unstable; urgency=medium

  * udev: create /dev/mapper/dmroot -> xvda3 symlink when its mounted
    directly

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 03 Jul 2018 21:11:00 +0200

qubes-utils (4.0.19) unstable; urgency=medium

  * rpm: use proper macros for systemd handling
  * travis: add centos7

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Wed, 02 May 2018 17:55:09 +0200

qubes-utils (4.0.18) unstable; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * udev: don't call udev-block-add-change for devices excluded by other
    rules
  * rpm: preparation for src.rpm building

  [ Frédéric Pierret ]
  * Makefile.builder: currently disable Mock
  * Remove _builddir
  * Fix debug symbols
  * spec.in: add changelog placeholder

  [ Marek Marczykowski-Górecki ]
  * travis: update Fedora versions

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sat, 21 Apr 2018 14:36:39 +0200

qubes-utils (4.0.17) unstable; urgency=medium

  [ Frédéric Pierret ]
  * Fix python3 package names with respect to CentOS for consistency
    with python34 names
  * Remove busybox as it is not provided in RHEL7 anymore
  * centos: fix python packages names
  * drop busybox dependance

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 27 Feb 2018 15:17:12 +0100

qubes-utils (4.0.16) unstable; urgency=medium

  * qrexec: provide common function for handling service call
  * debian: adjust required version after adding new function

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 20 Feb 2018 00:05:31 +0100

qubes-utils (4.0.15) unstable; urgency=medium

  * udev: update detecting usbip-connected devices

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Thu, 18 Jan 2018 19:07:40 +0100

qubes-utils (4.0.14) unstable; urgency=medium

  [ Reynir Björnsson ]
  * Remove duplicate #define

  [ Rusty Bird ]
  * udev-block-add-change: ignore unconnected Network Block Device

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Fri, 12 Jan 2018 06:16:05 +0100

qubes-utils (4.0.13) unstable; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * imgconverter: fix make_padlock function
  * Update tests
  * travis: run imgconverter unit tests
  * Make tests python3 compatible
  * travis: run tests also on python3
  * travis: enable deploy stage for master-staging -> master gate

  [ Gianluca Guida ]
  * Fix qrexec-lib headers

  [ Marek Marczykowski-Górecki ]
  * imgconverter: fix handling explicit file type
  * tests: integration tests for qvm-convert-img
  * travis: run only unit tests

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sat, 23 Dec 2017 02:50:19 +0100

qubes-utils (4.0.12) unstable; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * debian: make it easier to spot missing files in debian/*.install
  * debian: include drauct module in qubes-kernel-vm-support

  [ Patrick Schleizer ]
  * qubes-kernel-vm-support compatibility with dracut

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 12 Dec 2017 01:41:52 +0100

qubes-utils (4.0.11) unstable; urgency=medium

  [ qubesuser ]
  * remove unused cairo import
  * add Python pillow and numpy dependencies
  * use PIL image library instead of ImageMagick to load/save images
    when tinting
  * reimplement tint algorithm with numpy for reasonable performance
  * replace tinting algorithm with one that partially preserves
    saturation too

  [ Marek Marczykowski-Górecki ]
  * Add missing classmethod decorator
  * Make udev-block-add-change executable again

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 21 Nov 2017 05:34:50 +0100

qubes-utils (4.0.10) unstable; urgency=medium

  [ Olivier MEDOC ]
  * archlinux: build imgconverter with both python2 and python3

  [ qubesuser ]
  * Speed up udev-block-add-change by not using xenstore

  [ Your Name ]
  * This commit specifies the integer width explicitly to match
    `result_header_ext` etc.

  [ Marek Marczykowski-Górecki ]
  * Initialize pad field in filecopy final response

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 21 Nov 2017 04:46:49 +0100

qubes-utils (4.0.9) unstable; urgency=medium

  * Fix initramfs scripts on Debian
  * qubes-prepare-vm-kernel: Include kernel and initramfs inside
    modules.img
  * initramfs: add support for variable partitions layout

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 17 Oct 2017 23:54:15 +0200

qubes-utils (4.0.8) unstable; urgency=medium

  [ Frédéric Pierret ]
  * Fix CentOS dependencies: python3

  [ Marek Marczykowski-Górecki ]
  * travis: add fc26 build

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sat, 30 Sep 2017 01:59:38 +0200

qubes-utils (4.0.7) unstable; urgency=medium

  [ Olivier MEDOC ]
  * Fix gcc Werror because of a typo in a switch/case explicit
    fallthrough comment

  [ Marek Marczykowski-Górecki ]
  * udev: fix loop devices exclusion based on directory flagfile

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Fri, 15 Sep 2017 13:43:18 +0200

qubes-utils (4.0.6) unstable; urgency=medium

  [ Jean-Philippe Ouellet ]
  * Fix off-by-one error in header length calculation

  [ Marek Marczykowski-Górecki ]
  * udev: major cleanup in block devices handling

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 12 Sep 2017 04:52:48 +0200

qubes-utils (4.0.5) unstable; urgency=medium

  * udev: filter-out QEMU devices

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Fri, 11 Aug 2017 13:34:11 +0200

qubes-utils (4.0.4) unstable; urgency=medium

  [ HW42 ]
  * u2mfn: get mfn via pte

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sat, 29 Jul 2017 05:19:34 +0200

qubes-utils (4.0.3) unstable; urgency=medium

  [ Rusty Bird ]
  * Fall back to sync() if syncfs() is unavailable

  [ Marek Marczykowski-Górecki ]
  * udev: don't list in qvm-block any device marked to be ignored by
    udev

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Thu, 06 Jul 2017 19:41:04 +0200

qubes-utils (4.0.2) unstable; urgency=medium

  [ Paras Chetal ]
  * Fix include header syntax

  [ Marek Marczykowski-Górecki ]
  * initramfs: use symlink for rw root.img, instead of dm-linear

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sat, 24 Jun 2017 14:55:03 +0200

qubes-utils (4.0.1) unstable; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * travis: switch to Qubes 4.0
  * rpm: add missing build requires
  * travis: drop fc23 vm packages building

  [ unman ]
  * Improve error message when file exists

  [ Marek Marczykowski-Górecki ]
  * rpm: packge qubesimgconverter for both python2 and python3
  * imgconverter: make it really work on python3
  * imgconverter: use core3 API in get_from_vm()
  * rpm: add missing build requires

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Thu, 18 May 2017 01:54:46 +0200

qubes-utils (4.0.0) unstable; urgency=medium

  [ Wojtek Porczyk ]
  * debian/control: remove unneeded qubesdb dependency
  * Package imgconverter as separate Python module
  * Move imggen module from artwork.

  [ Marek Marczykowski-Górecki ]
  * dracut: add missing 'die' function to 'simple' module
  * qmemman-meminfo-writer: send simplified meminfo value
  * Add python-setuptools to build depends
  * debian: adjust file list
  * Install python modules to /usr
  * initramfs: move qubes_cow_setup hook to pre-trigger
  * initramfs: add support for root.img with partition table
  * debian: fix install location of python files

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sat, 08 Apr 2017 13:58:53 +0200

qubes-utils (3.2.4) unstable; urgency=medium

  [ Johanna A ]
  * Builds against 4.9

  [ Marek Marczykowski-Górecki ]
  * udev: use DM ignore device flag only for DM devices

  [ Olivier MEDOC ]
  * archlinux: clean up qubes-prepare-vm-kernel
  * archlinux: clean up PKGBUILD and bump version number

  [ Marek Marczykowski-Górecki ]
  * travis: drop debootstrap workaround

  [ Olivier MEDOC ]
  * archlinux: use dracut native file instead of our own

  [ M. Vefa Bicakci ]
  * qubes-prepare-vm-kernel: Do not hardcode path to dracut

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Thu, 23 Mar 2017 11:34:01 +0100

qubes-utils (3.2.3) wheezy; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * udev: make USB device version detection more generic
  * debian: reformat Build-Depends
  * debian: add pkg-config to Build-Depends

  [ Rusty Bird ]
  * udev-block-add-change: better mount status check
  * udev-block-add-change: don't exclude already attached devs
  * udev-block-add-change: simplify a check

  [ Marek Marczykowski-Górecki ]
  * udev-block-add-change: fix checking if partition is mounted

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sun, 17 Jul 2016 05:17:40 +0200

qubes-utils (3.2.2) wheezy; urgency=medium

  * udev: expose USB 3.0 devices for PV USB
  * udev: ignore usbip-connected USB devices
  * udev: fix removing USB entries
  * qrexec-lib: convert tabs to spaces
  * travis: initial version

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Thu, 02 Jun 2016 02:55:11 +0200

qubes-utils (3.2.1) wheezy; urgency=medium

  * udev: fix deadlock on xenstore access during dom0 boot

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Wed, 18 May 2016 02:59:37 +0200

qubes-utils (3.2.0) wheezy; urgency=medium

  [ Johanna A ]
  * Builds against linux v4.6-rc4

  [ Marek Marczykowski-Górecki ]
  * u2mfn: build for both 4.6+ and older kernels
  * udev/qvm-block: exclude devices used elsewhere
  * udev/qvm-block: exclude device if its partition is already attached

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Mon, 16 May 2016 11:54:16 +0200

qubes-utils (3.1.8) wheezy; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * udev: fix hiding devices from qvm-block

  [ Olivier MEDOC ]
  * archlinux: ensure gcc, make and pkgconfig are makedependencies
  * archlinux: implement kernel-support
  * kernel-support: compile u2mfn from source even if it has been never
    built
  * archlinux: add an install file specifically for vm-kernel-support
  * archlinux: fix syntax errors in install file

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Mon, 08 Feb 2016 05:06:21 +0100

qubes-utils (3.1.7) wheezy; urgency=medium

  [ pqg ]
  * Fix build (installation) on Archlinux

  [ Marek Marczykowski-Górecki ]
  * Fix building Fedora package after Archlinux build fixes
  * udev: do not assume static device-mapper major number
  * udev: ignore devices set to be ignore elsewhere

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Thu, 07 Jan 2016 05:59:40 +0100

qubes-utils (3.1.6) wheezy; urgency=medium

  [ HW42 ]
  * debian: remove obsolete conffiles in /etc/udev/rules.d

  [ Marek Marczykowski-Górecki ]
  * qrexec-lib: add glibc version test check for having syncfs

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sun, 13 Dec 2015 04:38:27 +0100

qubes-utils (3.1.5) wheezy; urgency=medium

  * Fix for "debian: split libraries out of qubes-utils package"

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Mon, 30 Nov 2015 05:55:14 +0100

qubes-utils (3.1.4) wheezy; urgency=medium

  [ qubesuser ]
  * Fix u2mfn.ko for > 16TB RAM by not truncating to 32-bit improperly

  [ Rusty Bird ]
  * Check if QubesIncoming filesystem supports O_TMPFILE

  [ Marek Marczykowski-Górecki ]
  * rpm: disable debuginfo subpackage in qubes-kernel-vm-support
  * initramfs: fix swap size
  * qrexec: add clarification commends in qrexec.h

  [ Rusty Bird ]
  * qfile-unpacker: syncfs() to avoid qvm-move-to-vm data loss

  [ Marek Marczykowski-Górecki ]
  * initramfs: use units of sectors in sfdisk call
  * initramfs: initialize volatile.img partition table also in
    TemplateVM
  * qubes-prepare-vm-kernel: ensure proper permissions on initramfs
  * debian: resolve quilt-build-dep-but-no-series-file lintian warning
  * Move udev scripts to /usr/lib/qubes, move rules to /lib/udev/
  * makefile: honor build env CFLAGS and LDFLAGS
  * debian: split libraries out of qubes-utils package
  * debian: break hardlink before modifying debian/....dkms

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Fri, 27 Nov 2015 20:44:04 +0100

qubes-utils (3.1.3) wheezy; urgency=medium

  * qrexec-lib: add qfile packing functions to libqubes-rpc-filecopy
  * dracut: split 'full' dracut module into 'full-dmroot' and 'full-
    modules'
  * dracut: fix qubes-vm module dependencies
  * dracut: mount only subdirectory of /lib/modules
  * kernel-modules: build/install u2mfn module by default
  * dracut: add dmsetup --noudevsync since we're running in pre-udev
    hook
  * debian: introduce qubes-kernel-vm-support package
  * dracut: add a safety check preventing qubes_cow_setup.sh running in
    dom0
  * qrexec: define NOGUI_CMD_PREFIX

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Wed, 11 Nov 2015 05:12:11 +0100

qubes-utils (3.1.2) wheezy; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * dracut: expand tabs to spaces
  * dracut: abort on dmroot assemble error
  * dracut: initialize volatile.img partitions
  * libqrexec-utils: fix linker options
  * libqrexec-utils: bring back buffered write helpers
  * libqrexec-utils: bump SO version because of ABI change

  [ qubesuser ]
  * Fix u2mfn.ko for > 16TB RAM by not truncating to 32-bit improperly

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sat, 24 Oct 2015 23:05:02 +0200

qubes-utils (3.1.1) wheezy; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * qfile-unpacker: do not call fdatasync() at each file (#1257)

  [ qubesuser ]
  * Report Xen balloon current size instead of Linux total memory
  * use 64-bit integers for memory sizes to support > 2 TB RAM

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sun, 11 Oct 2015 02:48:12 +0200

qubes-utils (3.1.0) wheezy; urgency=medium

  * impconverter: add icon data getters

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Wed, 30 Sep 2015 22:13:51 +0200

qubes-utils (3.0.10) wheezy; urgency=medium

  [ Olivier MEDOC ]
  * archlinux: update to match new dependancies and archlinux /usr/lib
    guidelines
  * archlinux: ensure /usr/sbin is not use to follow archlinux packaging
    guidelines

  [ Marek Marczykowski-Górecki ]
  * imgconverter: ensure that connection to the VM is properly closed

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sat, 08 Aug 2015 04:23:00 +0200

qubes-utils (3.0.9) wheezy; urgency=medium

  * imgconverter: use more meaningful error for empty icon image

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Wed, 08 Jul 2015 05:58:15 +0200

qubes-utils (3.0.8) wheezy; urgency=medium

  * fedora: fix systemd service files permission
  * udev: do not use a separate lock for udev block scripts

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Wed, 01 Jul 2015 07:11:28 +0200

qubes-utils (3.0.7) wheezy; urgency=medium

  * imgconverter: add eq operation for Image class

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 28 Apr 2015 13:23:09 +0200

qubes-utils (3.0.6) wheezy; urgency=medium

  * imgconverter: do not start gui daemon

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Wed, 15 Apr 2015 18:49:02 +0200

qubes-utils (3.0.5) wheezy; urgency=medium

  * udev: fix block devices ignoring rule

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Fri, 03 Apr 2015 11:26:47 +0200

qubes-utils (3.0.4) wheezy; urgency=medium

  * udev: ignore temporary devices created during VM startup

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Wed, 01 Apr 2015 00:11:15 +0200

qubes-utils (3.0.3) wheezy; urgency=medium

  * qrexec-lib: enable compiler optimization
  * udev: allow normal user to access /dev/xen/xenbus for vchan
    connections
  * Add VM kernel related files as qubes-core-vm-kernel-support package
  * dracut: do not assume full udevd running inside initramfs
  * Provide a script to generate VM kernel files
  * dracut: Provide minimalistic initramfs files - no udev, no systemd
  * dracut: load ext4 module manually in minimalistic dracut module
  * Compile u2mfn module only when not already present

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Thu, 26 Mar 2015 23:57:42 +0100

qubes-utils (3.0.2) jessie; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * qrexec: create stdin/out/err as sockets instead of pipes
  * debian: O_TMPFILE already defined

  [ Jason Mehring ]
  * Removed -Werror from qrexec Makefile to allow unpack to compile for
    both Fedora 20 and 21
  * debian:  Modified control file for new R3 Debian depends
  * debian: Updated changelog to reflect 3.0.1 version change
  * debian:  Added qubesdb-vm as a depend
  * debian: Revert back to using libxen-dev as depend

  [ Marek Marczykowski-Górecki ]
  * Revert "Removed -Werror from qrexec Makefile to allow unpack to
    compile for both Fedora 20 and 21"

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 17 Feb 2015 14:22:38 +0100

qubes-utils (3.0.1) jessie; urgency=medium

  [ Wojciech Zygmunt Porczyk ]
  * v3.0.1
  * This has to be versioned because of dependency in core-agent-linux.

  [ Marek Marczykowski-Górecki ]
  * Update for new vchan API, remove code not needed anymore
  * filecopy: fix handling ENOENT error
  * Do not fail when file was successfully created.
  * I will test before commit. I will test before commit. I will...

  [ Marek Marczykowski-Górecki ]
  * filecopy: really do not use O_TMPFILE when use_tmpfile==0
  * When file opened with O_TMPFILE but use_tmpfile==0, the file will not be
    linked to the directory (the code at the end of process_one_file_reg).
    Additionally it is waste of time trying using O_TMPFILE when it's
    already known it shouldn't be.
    Also use_tmpfile==0 can mean we don't have access to /proc
    (set_procfs_fd wasn't called), so even if linking the file to its
    directory would be attempted, it would fail. This is the case for
    dom0-updates copy.

  [ Marek Marczykowski-Górecki ]
  * filecopy: create new file unaccessible to the user until fully written
    Otherwise source domain can modify (append) the file while the user
    already is accessing it. While incoming files should be treated as
    untrusted, this problem could allow file modification after the user
    makes some sanity checks.

  [ Marek Marczykowski-Górecki ]
  * udev: update hotplug block scripts for QubesDB
  * Some initial work was done, but apparently not complete and buggy.

  [ Marek Marczykowski-Górecki ]
  * version 3.0.0

  [ Marek Marczykowski-Górecki ]
  * Fix compile warnings

  [ Marek Marczykowski-Górecki ]
  * qrexec-utils: add read_vchan_all and write_vchan_all
  * Similar to read_all and write_all.

  [ Marek Marczykowski-Górecki ]
  * qrexec: update protocol
    - add new messages
    - uniform packet header
    - organize #defines

  [ Marek Marczykowski-Górecki ]
  * code style: change tabs to spaces

  [ Marek Marczykowski-Górecki ]
  * qrexec-utils: disable write-stdin (buffered writes) compilation
  * Not compatible with new qrexec protocol yet. To be done.

  [ Marek Marczykowski-Górecki ]
  * New qrexec protocol
  * Use separate vchan to pass I/O for each process, which greatly simplify
    protocol implementation (eg. no flow control needed).

  [ Marek Marczykowski-Górecki ]
  * udev: setup permissions on xen device nodes

  [ Marek Marczykowski ]
  * qrexec-lib: prevent deadlock on vchan
    It can happen that we already cleared libvchan_fd pending state via
    libvchan_wait, but data arrived later. This is especially true just
    after connection, when client send unsolicited notification to server,
    which can confuse it with some requested notification.

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Tue, 10 Feb 2015 00:00:00 +0100

qubes-utils (3.0.0) jessie; urgency=medium

  [ HW42 ]
  * use systemd in debian

  [ Marek Marczykowski ]
  * Update for new vchan API, remove code not needed anymore
  * Use Qubes DB instead of Xenstore
  * qrexec-lib: prevent deadlock on vchan

  [ Marek Marczykowski-Górecki ]
  * udev: setup permissions on xen device nodes
  * New qrexec protocol
  * qrexec-utils: disable write-stdin (buffered writes) compilation
  * code style: change tabs to spaces
  * qrexec: update protocol
  * qrexec-utils: add read_vchan_all and write_vchan_all

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Sat, 22 Nov 2014 16:24:11 +0100
qubes-utils (2.0.14) jessie; urgency=medium

  [ Marek Marczykowski-Górecki ]
  * qrexec-lib: use _exit in child process to not fire atexit hooks
  * version 2.0.9

  [ Wojciech Zygmunt Porczyk ]
  * move site-packages/qubes/__init__.py from core-admin
  * imgconverter.py: really close stdout in get_through_dvm

  [ Marek Marczykowski-Górecki ]
  * udev: better support device-mapper/LVM
  * version 2.0.10
  * udev: fix perms of udev-block-add-change
  * udev: skip empty device-mapper nodes
  * version 2.0.11
  * udev: filter out template's root device
  * udev: convert device description to ascii only
  * version 2.0.12
  * rpm: add missing dependency

  [ Joanna Rutkowska ]
  * version 2.0.13

  [ Davíð Steinn Geirsson ]
  * Add qmemman to make clean
  * Use xenstore.h when xen >= 4.2
  * Initial native debian packaging

  [ Marek Marczykowski-Górecki ]
  * debian: rename package to qubes-utils, update deps
  * gitignore

 -- Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>  Mon, 28 Jul 2014 02:46:39 +0200

qubes-utils (2.0.8) jessie; urgency=low

  * Initial Release.

 -- Davíð Steinn Geirsson <david@dsg.is>  Sun, 20 Apr 2014 21:47:01 +0000
